import{V as e,W as r,a4 as t,cY as i,cy as s,aT as a,ca as o,X as n,cI as l,cZ as u,aS as p,r as c,c_ as y,c9 as d,L as f,c$ as m}from"../main.js";import{c as B,i as h,u as g,d as v,a as b,p as P,o as R}from"./networkService-6b59782c.js";import"./GPMessage-9cb8657d.js";function S(e){return e.features.map((r=>{const t=p.fromJSON(e.spatialReference),i=o.fromJSON(r);return c(i.geometry)&&(i.geometry.spatialReference=t),i}))}function A(e){return u.fromJSON(e).features.map((e=>e.geometry))}let N=class extends l{constructor(e){super(e),this.directions=null,this.facilities=null,this.incidents=null,this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.routes=null}readFacilities(e){return A(e)}readIncidents(e){return A(e)}readPointBarriers(e,r){return A(r.barriers)}readPolylineBarriers(e){return A(e)}readPolygonBarriers(e){return A(e)}readRoutes(e){return S(e)}};e([r({type:[B]})],N.prototype,"directions",void 0),e([r({type:[t]})],N.prototype,"facilities",void 0),e([i("facilities")],N.prototype,"readFacilities",null),e([r({type:[t]})],N.prototype,"incidents",void 0),e([i("incidents")],N.prototype,"readIncidents",null),e([r({type:[h]})],N.prototype,"messages",void 0),e([r({type:[t]})],N.prototype,"pointBarriers",void 0),e([i("pointBarriers",["barriers"])],N.prototype,"readPointBarriers",null),e([r({type:[s]})],N.prototype,"polylineBarriers",void 0),e([i("polylineBarriers")],N.prototype,"readPolylineBarriers",null),e([r({type:[a]})],N.prototype,"polygonBarriers",void 0),e([i("polygonBarriers")],N.prototype,"readPolygonBarriers",null),e([r({type:[o]})],N.prototype,"routes",void 0),e([i("routes")],N.prototype,"readRoutes",null),N=e([n("esri.rest.support.ClosestFacilitySolveResult")],N);var k=N;const C=R({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,directionsTimeAttribute:{name:"directionsTimeAttributeName"},impedanceAttribute:{name:"impedanceAttributeName"},facilities:!0,incidents:!0,outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},returnPointBarriers:{name:"returnBarriers"},returnRoutes:{name:"returnCFRoutes"},travelMode:!0});let F=class extends m{constructor(e){super(e),this.url=null}solve(e,r){return async function(e,r,t){const i=[],s=[],a={},o={},n=y(e);return r.incidents&&r.incidents.features&&g(r.incidents.features,s,"incidents.features",a),r.facilities&&r.facilities.features&&g(r.facilities.features,s,"facilities.features",a),r.pointBarriers&&r.pointBarriers.features&&g(r.pointBarriers.features,s,"pointBarriers.features",a),r.polylineBarriers&&r.polylineBarriers.features&&g(r.polylineBarriers.features,s,"polylineBarriers.features",a),r.polygonBarriers&&r.polygonBarriers.features&&g(r.polygonBarriers.features,s,"polygonBarriers.features",a),d(s).then((e=>{for(const r in a){const t=a[r];i.push(r),o[r]=e.slice(t[0],t[1])}return v(o,i)?b(n.path):Promise.resolve({dontCheck:!0})})).then((e=>{("dontCheck"in e?e.dontCheck:e.hasZ)||P(o,i);for(const e in o)o[e].forEach(((t,i)=>{r.get(e)[i].geometry=t}));let s={query:{...n.query,f:"json",...C.toQueryParams(r)}};return t&&(s={...t,...s}),f(`${n.path}/solveClosestFacility`,s)})).then((e=>k.fromJSON(e.data)))}(this.url,e,r)}};e([r()],F.prototype,"url",void 0),F=e([n("esri.tasks.ClosestFacilityTask")],F);var j=F;export{j as default};
