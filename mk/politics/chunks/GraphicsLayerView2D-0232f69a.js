import{ck as i,ch as t,Z as e,_ as s,a0 as r}from"../main.js";import{f as a,u as h}from"./LayerView-2a9200ad.js";import{i as o}from"./GraphicContainer-0a97fbff.js";import{r as p}from"./BaseGraphicContainer-6b173879.js";import"./Container-4f30f201.js";import"./Utils-be23a2c6.js";import"./enums-7acaa04d.js";import"./number-b530ed41.js";import"./enums-154d47de.js";import"./Texture-8b92d5d4.js";import"./VertexElementDescriptor-d5c236cd.js";import"./CIMSymbolHelper-cbb4397a.js";import"./BidiEngine-07ac28a3.js";import"./alignmentUtils-3fedcae3.js";import"./GeometryUtils-fb44f136.js";import"./projectionSupport-8797065d.js";import"./json-c16bd509.js";import"./VertexArrayObject-a92d69a3.js";import"./FeatureContainer-71418fa3.js";import"./TileContainer-c1a76147.js";import"./WGLContainer-13b2f2d5.js";import"./pixelUtils-ea0d20a1.js";import"./ProgramTemplate-6ba228e0.js";import"./StyleDefinition-3db9be87.js";import"./config-dc0b399b.js";import"./GeometryUtils-ba0d6a93.js";import"./MaterialKey-c7d0c6a2.js";import"./earcut-9a1bd483.js";import"./visualVariablesUtils-fe844d46.js";import"./visualVariablesUtils-bfc5f6ed.js";import"./Matcher-5a877f99.js";import"./tileUtils-359d8faa.js";import"./TileClipper-b46e776d.js";import"./Geometry-35a30b9e.js";import"./cimAnalyzer-7a366be2.js";import"./quantizationUtils-6ec6d37f.js";import"./ExpandedCIM-ce334afc.js";import"./schemaUtils-9dbe5b20.js";import"./createSymbolSchema-6ec90458.js";import"./MD5-318d1b0b.js";import"./util-d39d466d.js";import"./ComputedAttributeStorage-13642635.js";import"./vec3f32-89f63e00.js";const l={remove(){},pause(){},resume(){}};let d=class extends(a(h)){constructor(){super(...arguments),this._highlightIds=new Map}attach(){this.graphicsView=new p({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:this.layer.graphics,container:new o(this.view.featuresTilingScheme)}),this._updateHighlight(),this.container.addChild(this.graphicsView.container),this.handles.add(this.layer.on("graphic-update",this.graphicsView.graphicUpdateHandler),"graphicslayerview2d")}detach(){this.container.removeAllChildren(),this.graphicsView.destroy(),this.graphicsView=null,this.handles.remove("graphicslayerview2d")}async hitTest(i){return this.graphicsView?this.graphicsView.hitTest(i):null}async fetchPopupFeatures(i){if(this.graphicsView)return this.graphicsView.hitTest(i).filter((i=>!!i.popupTemplate))}queryGraphics(){return Promise.resolve(this.graphicsView.graphics)}update(i){this.graphicsView.processUpdate(i)}moveStart(){}viewChange(){this.graphicsView.viewChange()}moveEnd(){}isUpdating(){return!this.graphicsView||this.graphicsView.updating}highlight(e){var s;let r;return"number"==typeof e?r=[e]:e instanceof i?r=[e.uid]:Array.isArray(e)&&e.length>0?r="number"==typeof e[0]?e:e.map((i=>i&&i.uid)):t.isCollection(e)&&e.length>0&&(r=e.map((i=>i&&i.uid)).toArray()),r=null==(s=r)?void 0:s.filter((i=>null!=i)),r.length?(this._addHighlight(r),{remove:()=>this._removeHighlight(r)}):l}_addHighlight(i){for(const t of i)if(this._highlightIds.has(t)){const i=this._highlightIds.get(t);this._highlightIds.set(t,i+1)}else this._highlightIds.set(t,1);this._updateHighlight()}_removeHighlight(i){for(const t of i)if(this._highlightIds.has(t)){const i=this._highlightIds.get(t)-1;0===i?this._highlightIds.delete(t):this._highlightIds.set(t,i)}this._updateHighlight()}_updateHighlight(){var i;null==(i=this.graphicsView)||i.setHighlight(Array.from(this._highlightIds.keys()))}};e([s()],d.prototype,"graphicsView",void 0),d=e([r("esri.views.2d.layers.GraphicsLayerView2D")],d);const m=d;export{m as default};
