import{by as e,bz as t,i0 as a,bB as n,i1 as l,bw as s,e as r,bA as o,bC as i,bD as m,i2 as b,i3 as y,i4 as u,bx as c}from"../main.js";import{c as f,a as p}from"./devEnvironmentUtils-94bcfc53.js";function g(o,i,m,b){return o.name?o.styleName&&"Esri2DPointSymbolsStyle"===o.styleName?function(s,r,o){const i=c.replace(/\{SymbolName\}/gi,s.name);return e(i,o).then((e=>{const s=t(e.data);return a(s,{portal:r.portal,url:n(l(i)),origin:"portal-item"})}))}(o,i,b):s(o,i,b).then((e=>h(e,o.name,i,m,b))):Promise.reject(new r("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))}function h(s,c,g,h,d){const w=s.data,N={portal:g&&g.portal||o.getDefault(),url:n(s.baseUrl),origin:"portal-item"},S=w.items.find((e=>e.name===c));if(!S){const e=`The symbol name '${c}' could not be found`;return Promise.reject(new r("symbolstyleutils:symbol-name-not-found",e,{symbolName:c}))}let U=i(m(S,h),N),j=S.thumbnail&&S.thumbnail.href;const D=S.thumbnail&&S.thumbnail.imageData;f()&&(U=p(U),j=p(j));const v={portal:g.portal,url:n(l(U)),origin:"portal-item"};return e(U,d).then((e=>{const n="cimRef"===h?t(e.data):e.data,l=a(n,v);if(l&&b(l)){if(j){const e=i(j,N);l.thumbnail=new y({url:e})}else D&&(l.thumbnail=new y({url:`data:image/png;base64,${D}`}));s.styleUrl?l.styleOrigin=new u({portal:g.portal,styleUrl:s.styleUrl,name:c}):s.styleName&&(l.styleOrigin=new u({portal:g.portal,styleName:s.styleName,name:c}))}return l}))}export{h as fetchSymbolFromStyle,g as resolveWebStyleSymbol};
