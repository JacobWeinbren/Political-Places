import{bw as e,bx as t,hM as a,bz as n,hN as l,bu as s,e as r,by as o,bA as m,bB as i,hO as b,hP as y,hQ as u,bv as c}from"../main.js";import{c as f,a as p}from"./devEnvironmentUtils-bfd22fcb.js";function h(o,m,i,b){return o.name?o.styleName&&"Esri2DPointSymbolsStyle"===o.styleName?function(s,r,o){const m=c.replace(/\{SymbolName\}/gi,s.name);return e(m,o).then((e=>{const s=t(e.data);return a(s,{portal:r.portal,url:n(l(m)),origin:"portal-item"})}))}(o,m,b):s(o,m,b).then((e=>g(e,o.name,m,i,b))):Promise.reject(new r("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))}function g(s,c,h,g,d){const N=s.data,w={portal:h&&h.portal||o.getDefault(),url:n(s.baseUrl),origin:"portal-item"},S=N.items.find((e=>e.name===c));if(!S){const e=`The symbol name '${c}' could not be found`;return Promise.reject(new r("symbolstyleutils:symbol-name-not-found",e,{symbolName:c}))}let U=m(i(S,g),w),j=S.thumbnail&&S.thumbnail.href;const v=S.thumbnail&&S.thumbnail.imageData;f()&&(U=p(U),j=p(j));const P={portal:h.portal,url:n(l(U)),origin:"portal-item"};return e(U,d).then((e=>{const n="cimRef"===g?t(e.data):e.data,l=a(n,P);if(l&&b(l)){if(j){const e=m(j,w);l.thumbnail=new y({url:e})}else v&&(l.thumbnail=new y({url:`data:image/png;base64,${v}`}));s.styleUrl?l.styleOrigin=new u({portal:h.portal,styleUrl:s.styleUrl,name:c}):s.styleName&&(l.styleOrigin=new u({portal:h.portal,styleName:s.styleName,name:c}))}return l}))}export{g as fetchSymbolFromStyle,h as resolveWebStyleSymbol};
