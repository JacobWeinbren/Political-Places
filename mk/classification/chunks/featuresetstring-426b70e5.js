import{a as n}from"./arcadeUtils-06d89b42.js";import{h0 as e,ht as r,hw as t,gW as o,gY as a,hx as i,hA as c,kl as d,hv as u,hy as s,km as m,hz as f,kn as l,gQ as v,h2 as h,hu as y}from"../main.js";function p(e){return e&&e.domain?"coded-value"===e.domain.type||"codedValue"===e.domain.type?n.convertObjectToArcadeDictionary({type:"codedValue",name:e.domain.name,dataType:i[e.field.type],codedValues:e.domain.codedValues.map((n=>({name:n.name,code:n.code})))}):n.convertObjectToArcadeDictionary({type:"range",name:e.domain.name,dataType:i[e.field.type],min:e.domain.min,max:e.domain.max}):null}function w(i){"async"===i.mode&&(i.functions.domain=function(n,u){return i.standardFunctionAsync(n,u,(function(n,i,u){if(e(u,2,3),r(u[0]))return p(t(u[0],a(u[1]),void 0===u[2]?void 0:o(u[2])));if(c(u[0]))return u[0]._ensureLoaded().then((()=>p(d(a(u[1]),u[0],null,void 0===u[2]?void 0:o(u[2])))));throw new Error("Invalid Parameter")}))},i.functions.subtypes=function(t,o){return i.standardFunctionAsync(t,o,(function(t,o,a){if(e(a,1,1),r(a[0])){const e=u(a[0]);return e?n.convertObjectToArcadeDictionary(e):null}if(c(a[0]))return a[0]._ensureLoaded().then((()=>{const e=a[0].subtypes();return e?n.convertObjectToArcadeDictionary(e):null}));throw new Error("Invalid Parameter")}))},i.functions.domainname=function(n,t){return i.standardFunctionAsync(n,t,(function(n,t,i){if(e(i,2,4),r(i[0]))return s(i[0],a(i[1]),i[2],void 0===i[3]?void 0:o(i[3]));if(c(i[0]))return i[0]._ensureLoaded().then((()=>{const n=d(a(i[1]),i[0],null,void 0===i[3]?void 0:o(i[3]));return m(n,i[2])}));throw new Error("Invalid Parameter")}))},i.signatures.push({name:"domainname",min:"2",max:"4"}),i.functions.domaincode=function(n,t){return i.standardFunctionAsync(n,t,(function(n,t,i){if(e(i,2,4),r(i[0]))return f(i[0],a(i[1]),i[2],void 0===i[3]?void 0:o(i[3]));if(c(i[0]))return i[0]._ensureLoaded().then((()=>{const n=d(a(i[1]),i[0],null,void 0===i[3]?void 0:o(i[3]));return l(n,i[2])}));throw new Error("Invalid Parameter")}))},i.signatures.push({name:"domaincode",min:"2",max:"4"})),i.functions.text=function(n,r){return i.standardFunctionAsync(n,r,(function(n,r,t){if(e(t,1,2),!c(t[0]))return v(t[0],t[1]);{const e=h(t[1],"");if(""===e)return t[0].castToText();if("schema"===e.toLowerCase())return t[0].convertToText("schema",n.abortSignal);if("featureset"===e.toLowerCase())return t[0].convertToText("featureset",n.abortSignal)}}))},i.functions.gdbversion=function(n,t){return i.standardFunctionAsync(n,t,(function(n,t,o){if(e(o,1,1),r(o[0]))return o[0].gdbVersion();if(c(o[0]))return o[0].load().then((n=>n.gdbVersion));throw new Error("Invalid Parameter")}))},i.functions.schema=function(t,o){return i.standardFunctionAsync(t,o,(function(t,o,a){if(e(a,1,1),c(a[0]))return a[0].load().then((()=>n.convertObjectToArcadeDictionary(a[0].schema())));if(r(a[0])){const e=y(a[0]);return e?n.convertObjectToArcadeDictionary(e):null}throw new Error("Invalid Parameter")}))}}export{w as registerFunctions};
