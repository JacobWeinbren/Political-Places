import{ba as t,s as e,e as n}from"../main.js";import{k as r,m as s}from"./enums-c2efc4ce.js";import{F as a,G as i,C as o}from"./enums-38e3b49b.js";import"./Texture-56619848.js";import{t as c}from"./VertexElementDescriptor-a4fd480a.js";const u=new Float32Array(1);function l(t){return[255&t,(65280&t)>>>8,(16711680&t)>>>16,(4278190080&t)>>>24]}function E(t,e){return 65535&t|e<<16}function T(t,e,n,r){return 255&t|(255&e)<<8|(255&n)<<16|r<<24}var f,I,h,S,A,L,d;new Uint32Array(u.buffer),function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT",t[t.LABEL=4]="LABEL"}(f||(f={})),function(t){t[t.SUCCEEDED=0]="SUCCEEDED",t[t.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"}(I||(I={})),function(t){t[t.NONE=0]="NONE",t[t.MAP=1]="MAP",t[t.LABEL=2]="LABEL",t[t.LABEL_ALPHA=4]="LABEL_ALPHA",t[t.HITTEST=8]="HITTEST",t[t.HIGHLIGHT=16]="HIGHLIGHT",t[t.CLIP=32]="CLIP",t[t.DEBUG=64]="DEBUG",t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(h||(h={})),function(t){t[t.SIZE=0]="SIZE",t[t.COLOR=1]="COLOR",t[t.OPACITY=2]="OPACITY",t[t.ROTATION=3]="ROTATION"}(S||(S={})),function(t){t[t.NONE=0]="NONE",t[t.OPACITY=1]="OPACITY",t[t.COLOR=2]="COLOR",t[t.ROTATION=4]="ROTATION",t[t.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE",t[t.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS",t[t.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS",t[t.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"}(A||(A={})),function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(L||(L={})),function(t){t[t.SPRITE=0]="SPRITE",t[t.GLYPH=1]="GLYPH"}(d||(d={}));class m{constructor(){this.color=[0,0,0,0],this.haloColor=[0,0,0,0],this.haloSize=0,this.size=12,this.angle=0,this.offsetX=0,this.offsetY=0,this.hAnchor=0,this.vAnchor=0}acquire(t,e,n,r,s,a,i,o,c){this.color=t,this.haloColor=e,this.haloSize=n,this.size=r,this.angle=s,this.offsetX=a,this.offsetY=i,this.hAnchor=o,this.vAnchor=c}release(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0,this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0,this.haloSize=0,this.size=0,this.angle=0,this.offsetX=0,this.offsetY=0,this.hAnchor=0,this.vAnchor=0}}m.pool=new t(m);const _=e.getLogger("esri.views.2d.engine.webgl.Utils"),O="geometry",N=[{name:O,strideInBytes:32}],p=[{name:O,strideInBytes:20}],y=[{name:O,strideInBytes:12}],U=[{name:O,strideInBytes:40}],R=[{name:O,strideInBytes:36}],C=[{name:O,strideInBytes:36}];function g(t){const e={};for(const n of t)e[n.name]=n.strideInBytes;return e}const w=g([{name:O,strideInBytes:36}]),D=g(N),M=g(p),F=g(y),B=g(U),G=g(R),P=g(C);function v(t,{fill:e}){switch(t){case f.MARKER:return w;case f.FILL:return"dot-density"===e?F:"simple"===e?M:D;case f.LINE:return B;case f.TEXT:return G;case f.LABEL:return P}}const b=[O],H=[O],Y=[O],z=[O],x=[O];function X(t){switch(t){case f.MARKER:return b;case f.FILL:return H;case f.LINE:return Y;case f.TEXT:return z;case f.LABEL:return x}}function V(t){switch(t%4){case 0:case 2:return 4;case 1:case 3:return 1}}function Z(t,e){switch(e%4){case 0:case 2:return new Uint32Array(Math.floor(t*e/4));case 1:case 3:return new Uint8Array(t*e)}}function $(t,e){switch(e%4){case 0:case 2:return new Uint32Array(t);case 1:case 3:return new Uint8Array(t)}}function k(t){return null!=t}function j(t){return"number"==typeof t}function K(t){switch(t){case"butt":return r.BUTT;case"round":return r.ROUND;case"square":return r.SQUARE;default:return _.error(new n("mapview-invalid-type",`Cap type ${t} is not a valid option. Defaulting to round`)),r.ROUND}}function q(t){switch(t){case"miter":return s.MITER;case"bevel":return s.BEVEL;case"round":return s.ROUND;default:return _.error(new n("mapview-invalid-type",`Join type ${t} is not a valid option. Defaulting to round`)),s.ROUND}}function W(t){switch(t){case"opacity":return S.OPACITY;case"color":return S.COLOR;case"rotation":return S.ROTATION;case"size":return S.SIZE;default:return _.error(`Cannot interpret unknown vv: ${t}`),null}}function J(t,e,n,r,s,a,i){for(const e in a){const r=a[e].stride,i=V(r),o=a[e].data,c=n[e].data,u=r*s.vertexCount/i,l=r*t/i,E=r*s.vertexFrom/i;for(let t=0;t<u;++t)c[t+l]=o[t+E]}const o=s.indexCount;for(let n=0;n<o;++n)r[n+e]=i[n+s.indexFrom]-s.vertexFrom+t}const Q={[O]:a.STATIC_DRAW};function tt(t,e){const n=[];for(let r=0;r<5;++r){const s=X(r),a={};for(const t of s)a[t]={data:e(r,t)};n.push({data:t(r),buffers:a})}return n}function et(t){switch(t){case o.BYTE:case o.UNSIGNED_BYTE:return 1;case o.SHORT:case o.UNSIGNED_SHORT:return 2;case o.FLOAT:case o.INT:case o.UNSIGNED_INT:return 4}}function nt(t){switch(t){case i.UNSIGNED_BYTE:return 1;case i.UNSIGNED_SHORT_4_4_4_4:return 2;case i.FLOAT:return 4;default:return void _.error(new n("webgl-utils",`Unable to handle type ${t}`))}}function rt(t){switch(t){case i.UNSIGNED_BYTE:return Uint8Array;case i.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case i.FLOAT:return Float32Array;default:return void _.error(new n("webgl-utils",`Unable to handle type ${t}`))}}function st(t){const e={};for(const n in t){const r=t[n];let s=0;e[n]=r.map((t=>{const e=new c(t.name,t.count,t.type,s,0,t.normalized||!1);return s+=t.count*et(t.type),e})),e[n].forEach((t=>t.stride=s))}return e}const at=t=>{const e=new Map;for(const n in t)for(const r of t[n])e.set(r.name,r.location);return e},it=t=>{const e={};for(const n in t){const r=t[n];e[n]=r.length?r[0].stride:0}return e},ot=new Map,ct=(t,e)=>{if(!ot.has(t)){const n=st(e),r={strides:it(n),bufferLayouts:n,attributes:at(e)};ot.set(t,r)}return ot.get(t)};function ut(t){t(f.FILL),t(f.LINE),t(f.MARKER),t(f.TEXT),t(f.LABEL)}const lt=t=>"path"in t&&_t(t.path),Et=t=>"url"in t&&t.url||"imageData"in t&&t.imageData,Tt=t=>"imageData"in t&&t.imageData&&"contentType"in t&&t.contentType?`data:${t.contentType};base64,${t.imageData}`:"url"in t?t.url:null,ft=t=>"url"in t&&t.url&&t.url.includes(".gif")||"contentType"in t&&"image/gif"===t.contentType||"imageData"in t&&t.imageData.includes("data:image/gif"),It=t=>"url"in t&&t.url&&t.url.includes(".png")||"contentType"in t&&"image/png"===t.contentType||"imageData"in t&&t.imageData.includes("data:image/png"),ht=t=>t.type&&-1!==t.type.toLowerCase().indexOf("3d");function St(t){switch(t.type){case"line":{const e=t;return"CIMSolidStroke"===e.cim.type&&!e.dashTemplate}case"fill":return"CIMSolidFill"===t.cim.type;case"esriSFS":return"esriSFSSolid"===t.style||"esriSFSNull"===t.style;case"esriSLS":return"esriSLSSolid"===t.style||"esriSLSNull"===t.style;default:return!1}}const At=t=>t.includes("data:image/svg+xml");function Lt(t){switch("cim"in t?t.cim.type:t.type){case"esriSMS":case"esriPMS":case"CIMPointSymbol":case"CIMVectorMarker":case"CIMPictureMarker":case"CIMCharacterMarker":return!1;default:return!0}}function dt(t){const e="maxVVSize"in t&&t.maxVVSize,n="width"in t&&t.width||"size"in t&&t.size||0;return e||n}function mt(t){const e=[];for(let n=0;n<t.length;n++)e.push(t.charCodeAt(n));return e}const _t=t=>!!t&&(t=t.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(t)&&/[\dz]$/i.test(t)&&t.length>4));export{Lt as A,ht as E,$ as H,h as I,K as J,k as K,dt as L,l as M,mt as N,d as O,q as Q,At as S,ft as T,W,j as Z,L as _,St as a,f as b,E as c,ct as d,A as e,rt as f,Et as g,Tt as h,nt as i,V as k,tt as n,ut as p,Z as q,Q as r,J as t,It as w,T as x,lt as y,v as z};
